!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.iReal2MusicXML=t():e.iReal2MusicXML=t()}(this,(function(){return(()=>{var e={875:(e,t,n)=>{"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.r(t),n.d(t,{convert:()=>k});var i=function e(t){a(this,e);var n=/.*?irealb:\/\/([^"]*)/.exec(t),r=decodeURIComponent(n[1]).split("===");r.length>1&&(this.name=r.pop()),this.songs=r.map((function(e){return new d(e)}))},s=function e(){a(this,e),this.annots=[],this.comments=[],this.bars="",this.spacer=0,this.chord=null},c=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;a(this,e),this.note=t,this.modifiers=n,this.over=r,this.alternate=o},d=function(){function e(t){if(a(this,e),this.cells=[],!t)return this.title="",this.composer="",this.style="",this.key="",this.transpose=0,this.groove="",this.bpm=0,this.repeats=0,void(this.music="");var n=t.split("=");this.title=this.parseTitle(n[0].trim()),this.composer=this.parseComposer(n[1].trim()),this.style=n[3].trim(),this.key=n[4],this.transpose=+n[5]||0,this.groove=n[7],this.bpm=+n[8],this.repeats=+n[9]||3;var r=n[6].split("1r34LbKcu7");this.music=this.unscramble(r[1]),this.cells=this.parse()}var t,n;return t=e,(n=[{key:"parse",value:function(){for(var t=this.music.trim(),n=[];t;){for(var r=!1,o=0;o<e.regExps.length;o++){var a=e.regExps[o].exec(t);if(a){r=!0,a.length<=2?(n.push(a[0]),t=t.substr(a[0].length)):(n.push(a),t=t.substr(a[0].length));break}}r||(","!==t[0]&&n.push(t[0]),t=t.substr(1))}for(var i=[],s=this.newCell(i),d=null,u=0;u<n.length;u++){var l=n[u];switch(l instanceof Array&&(s.chord=this.parseChord(l),l=" "),l[0]){case"{":case"[":s.bars=l,l=null;break;case"|":d&&(d.bars+=")",d=null),s.bars="(",l=null;break;case"]":case"}":case"Z":d&&(d.bars+=l,d=null),l=null;break;case"n":s.chord=new c(l[0]);break;case",":l=null;break;case"S":case"T":case"Q":case"N":case"U":case"s":case"l":case"f":case"*":s.annots.push(l),l=null;break;case"Y":s.spacer++,l=null,d=null;break;case"r":case"x":case"W":s.chord=new c(l);break;case"<":l=l.substr(1,l.length-2),s.comments.push(l),l=null}l&&u<n.length-1&&(d=s,s=this.newCell(i))}return i}},{key:"parseTitle",value:function(e){return e.replace(/(.*)(, )(A|The)$/g,"$3 $1")}},{key:"parseComposer",value:function(e){var t=e.split(/(\s+)/);return 3==t.length?t[2]+t[1]+t[0]:e}},{key:"parseChord",value:function(t){var n=t[1]||" ",r=t[2]||"",o=t[3]||"";o&&(r+=o.substr(1,o.length-2));var a=t[4]||"";"/"===a[0]&&(a=a.substr(1));var i=t[5]||null;if(i&&(t=e.chordRegex.exec(i.substr(1,i.length-2)),i=t?this.parseChord(t):null)," "===n&&!i&&!a)return null;if(a){var s="#"===a[1]||"b"===a[1]?2:1;a=new c(a.substr(0,s),a.substr(s),null,null)}else a=null;return new c(n,r,a,i)}},{key:"newCell",value:function(e){var t=new s;return e.push(t),t}},{key:"unscramble",value:function(e){for(var t,n="";e.length>51;)t=e.substring(0,50),e=e.substring(50),n+=this.obfusc50(t);return(n+=e).replace(/Kcl/g,"| x").replace(/LZ/g," |").replace(/XyQ/g,"   ")}},{key:"obfusc50",value:function(e){for(var t=e.split(""),n=0;n<5;n++)t[49-n]=e[n],t[n]=e[49-n];for(var r=10;r<24;r++)t[49-r]=e[r],t[r]=e[49-r];return t.join("")}}])&&r(t.prototype,n),e}();o(d,"chordRegex",/^([A-G][b#]?)((?:sus|alt|add|[+\-^\dhob#])*)(\*.+?\*)*(\/[A-G][#b]?)?(\(.*?\))?/),o(d,"chordRegex2",/^([ Wp])()()(\/[A-G][#b]?)?(\(.*?\))?/),o(d,"regExps",[/^\*[a-zA-Z]/,/^T\d\d/,/^N./,/^<.*?>/,d.chordRegex,d.chordRegex2]);var u=n(308);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(){function e(t,n){p(this,e),this.song=t,this.options=n,this.time={beats:4,type:4},this.fifths=null,this.musicXml=(0,u.toXML)(this.convert(),{header:'\n<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE score-partwise PUBLIC "-//Recordare//DTD MusicXML 3.1 Partwise//EN" "http://www.musicxml.org/dtds/partwise.dtd">\n      '.trim(),indent:"  "})}return v(e,null,[{key:"convert",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign({},this.defaultOptions,n);return new e(t,r).musicXml}}]),v(e,[{key:"convert",value:function(){return{"score-partwise":[{"movement-title":this.song.title},{identification:[{_name:"creator",_attrs:{type:"composer"},_content:this.song.composer},{_name:"creator",_attrs:{type:"lyricist"},_content:this.song.style+(this.song.groove?" (".concat(this.song.groove,")"):"")},{encoding:[{software:"@infojunkie/ireal-musicxml"},{"encoding-date":e.convertDate(new Date)},{_name:"supports",_attrs:{element:"accidental",type:"no"}},{_name:"supports",_attrs:{element:"transpose",type:"no"}},{_name:"supports",_attrs:{attribute:"new-page",element:"print",type:"yes",value:"yes"}},{_name:"supports",_attrs:{attribute:"new-system",element:"print",type:"yes",value:"yes"}}]}]},{"part-list":{_name:"score-part",_attrs:{id:"P1"},_content:{_name:"part-name",_attrs:{"print-object":"no"},_content:"Lead sheet"}}},{_name:"part",_attrs:{id:"P1"},_content:this.convertMeasures()}]}}},{key:"convertMeasures",value:function(){var t=this,n=null,r=0;return this.song.cells.reduce((function(o,a,i){if(a.bars.match(/\(|\{|\[/)&&(n=new e.Measure(o.length+1),o.length||(n.attributes.push({divisions:t.options.divisions},{clef:[{sign:"G"},{line:2}]},{"measure-style":[{_name:"slash",_attrs:{type:"start","use-stems":"no"}}]},t.convertKey()),t.song.bpm&&n.body._content.push(t.convertTempo(t.song.bpm))),n.barlines.push(t.convertBarline(a.bars,"left")),r&&(n.chords=f(o[o.length-r-1].chords))),!n)return o;if(i%16==0&&n.body._content.splice(0,0,{_name:"print",_attrs:{"new-system":"yes"}}),a.annots.forEach((function(e){switch(e[0]){case"*":var r=e.slice(1);n.body._content.push(t.convertSection(r));break;case"T":var a=e.slice(1);n.attributes.push(t.convertTime(a));break;case"S":n.body._content.push(t.convertSegno());break;case"N":var i=parseInt(e.slice(1));if(n.barlines[0]._content.push(t.convertEnding(i,"start")),i>1){o[o.length-1].barlines[1]._content.push(t.convertEnding(i-1,"stop"));var s=o.slice().reverse().find((function(e){return e.barEnding===i-1}));s||console.error("[MusicXML.convertMeasures] Cannot find ending ".concat(i-1," in right barline of any measure"));var c=s.barlines[1]._content.findIndex((function(e){return"ending"===e._name}));-1===c&&console.error("[MusicXML.convertMeasures] Cannot find ending ".concat(i-1," in right barline of measure ").concat(s.number())),delete s.barlines[1]._content[c]}n.barEnding=i;break;case"Q":n.body._content.push(t.convertCoda());break;case"l":case"s":break;default:console.warn('[MusicXML.convertMeasures] Unrecognized annotation "'.concat(e,'"'))}})),a.chord)switch(a.chord.note){case"x":r=1,n.chords=f(o[o.length-r].chords);break;case"r":r=2,n.chords=f(o[o.length-r].chords);break;case"p":if(n.chords.length){n.chords[n.chords.length-1].spaces++;break}case"W":var s=n;s.chords.length||(s=o.slice().reverse().find((function(e){return e.chords.length})))||console.error("[MusicXML.convertMeasure] Cannot find any measure with chords prior to ".concat(a.chord));var c=s.chords[s.chords.length-1].ireal;c.over=a.chord.over,c.alternate=a.chord.alternate,n.chords.push(t.convertChord(c));break;case" ":console.warn("[MusicXML.convertMeasure] Unhandled empty/alternate chord ".concat(JSON.stringify(a.chord)));break;default:n.chords.push(t.convertChord(a.chord))}else r||n.chords.length&&n.chords[n.chords.length-1].spaces++;return a.bars.match(/\)|\}|\]|Z/)&&(n.barlines.push(t.convertBarline(a.bars,"right")),n.barEnding&&n.barlines[1]._content.push(t.convertEnding(n.barEnding,"discontinue")),t.adjustChordsDuration(n),o.push(n),n=null,r&&r--),o}),[]).map((function(e){return e.assemble()}))}},{key:"convertEnding",value:function(e,t){return{_name:"ending",_attrs:{number:e,type:t},_content:"".concat(e,".")}}},{key:"convertBarline",value:function(e,t){var n="left"===t?"none":"regular",r=null;return e.match(/\[|\]/)?n="light-light":e.match(/Z/)?n="light-heavy":e.match(/\{|\}/)&&(n="left"===t?"heavy-light":"light-heavy",r="left"===t?"forward":"backward"),{_name:"barline",_attrs:{location:t},_content:[{"bar-style":n},h({},r&&{_name:"repeat",_attrs:{direction:r}})]}}},{key:"convertSection",value:function(e){return"i"===e&&(e="Intro"),{_name:"direction",_attrs:{placement:"above"},_content:{"direction-type":{rehearsal:e}}}}},{key:"convertSegno",value:function(){return{_name:"direction",_attrs:{placement:"above"},_content:[{"direction-type":{_name:"segno"}},{_name:"sound",_attrs:{segno:"segno"}}]}}},{key:"convertCoda",value:function(){return{_name:"direction",_attrs:{placement:"above"},_content:[{"direction-type":{_name:"coda"}},{_name:"sound",_attrs:{coda:"coda"}}]}}},{key:"convertTempo",value:function(e){return{_name:"direction",_attrs:{placement:"above"},_content:[{"direction-type":[{_name:"metronome",_attrs:{parentheses:"no"},_content:[{"beat-unit":this.calculateChordDuration(1).type},{"per-minute":e}]}]},{_name:"sound",_attrs:{tempo:e}}]}}},{key:"convertTime",value:function(e){var t=parseInt(e[0]),n=parseInt(e[1]);return"12"===e&&(t=12,n=8),this.time={beats:t,type:n},{time:[{beats:t},{"beat-type":n}]}}},{key:"adjustChordsDuration",value:function(e){var t=this;if(e.chords.length>this.time.beats)console.error("[MusicXML.adjustChordDuration] Too many chords (".concat(e.chords.length," out of ").concat(this.time.beats,") in measure ").concat(e.number(),". Aborting."));else{var n=e.chords.reduce((function(e,t){return e+1+t.spaces}),0);if(n>this.time.beats){console.warn("[MusicXML.adjustChordDuration] Too many beats (".concat(n," out of ").concat(this.time.beats,") in measure ").concat(e.number(),". Removing some spaces..."));for(var r=0;n>this.time.beats;)e.chords[r].spaces>0&&(e.chords[r].spaces--,n--),r=(r+1)%e.chords.length}else for(var o=0;n<this.time.beats;)e.chords[o].spaces++,n++,o=(o+1)%e.chords.length;e.chords=e.chords.map((function(e){var n=t.calculateChordDuration(1+e.spaces),r=n.duration,o=n.type,a=n.dots;return e.note=t.convertChordNote(r,o,a),e}))}}},{key:"calculateChordDuration",value:function(e){var t={1:{t:"eighth",d:0},2:{t:"quarter",d:0},3:{t:"quarter",d:1},4:{t:"half",d:0},5:{t:null,d:null},6:{t:"half",d:1},7:{t:"half",d:2},8:{t:"whole",d:0},9:{t:null,d:null},10:{t:null,d:null},11:{t:null,d:null},12:{t:"whole",d:1}},n=8*e/this.time.type;e===this.time.beats&&(n=8),n in t||console.warn("[MusicXML.calculateChordDuration] Unexpected beat count ".concat(e," for time signature ").concat(this.time.beats,"/").concat(this.time.type));var r=t[n].t;return r||console.warn("[MusicXML.calculateChordDuration] Unhandled beat count ".concat(e," for time signature ").concat(this.time.beats,"/").concat(this.time.type)),{duration:e*this.options.divisions,type:r,dots:t[n].d}}},{key:"convertChordNote",value:function(t,n,r){var o="rest"===this.options.note.type?{_name:"rest"}:{_name:"pitch",_content:[{step:this.options.note.step},{alter:e.getMap(e.mapFifthsToAlters,this.fifths,[],'[MusicXML.convertChordNote] Unhandled fifths "'.concat(this.fifths,'"')).includes(this.options.note.step)?this.fifths>0?1:-1:0},{octave:this.options.note.octave}]};return e.reorderSequence([o,{notehead:this.options.note.notehead},{duration:t},{voice:1},{type:n}].concat(Array(r).fill({_name:"dot"})),e.sequenceNote)}},{key:"convertChord",value:function(t){var n=null;if("n"===t.note)n=[{root:[{_name:"root-step",_attrs:{text:""},_content:this.options.note.step}]},{_name:"kind",_attrs:{text:"N.C."},_content:"none"}];else{var r=t.note[0],o=e.getMap(e.mapAlter,t.note[1],null,'[MusicXML.convertChord] Unrecognized accidental in chord "'.concat(t.note,'"')),a={"":{text:"",kind:"major"},"-":{text:"m",kind:"minor"},"-#5":{text:"m",kind:"minor",degrees:[{d:5,a:1,t:"alter"}]},"-b6":{text:"m",kind:"minor",degrees:[{d:6,a:-1,t:"add"}]},"+":{text:"+",kind:"augmented"},sus:{text:"sus4",kind:"suspended-fourth"},sus4:{text:"sus4",kind:"suspended-fourth"},2:{text:"sus2",kind:"suspended-second"},sus2:{text:"sus2",kind:"suspended-second"},o:{text:"o",kind:"diminished"},"^":{text:"△7",kind:"major-seventh"},"^7":{text:"△7",kind:"major-seventh"},"^7#5":{text:"△7",kind:"major-seventh",degrees:[{d:5,a:1,t:"alter"}]},"^7#11":{text:"△7",kind:"major-seventh",degrees:[{d:11,a:1,t:"add"}]},"-^7":{text:"m△7",kind:"major-minor"},"-7":{text:"m7",kind:"minor-seventh"},"-7b5":{text:"m7♭5",kind:"half-diminished"},h7:{text:"ø7",kind:"half-diminished"},h:{text:"ø7",kind:"half-diminished"},o7:{text:"o7",kind:"diminished-seventh"},7:{text:"7",kind:"dominant"},"7#5":{text:"7",kind:"dominant",degrees:[{d:5,a:1,t:"alter"}]},"7+":{text:"7",kind:"dominant",degrees:[{d:5,a:1,t:"alter"}]},"7b5":{text:"7",kind:"dominant",degrees:[{d:5,a:-1,t:"alter"}]},"7sus":{text:"7sus4",kind:"dominant",degrees:[{d:3,a:1,t:"alter"}]},"7b9":{text:"7",kind:"dominant",degrees:[{d:9,a:-1,t:"add"}]},"7b9b5":{text:"7",kind:"dominant",degrees:[{d:5,a:-1,t:"alter"},{d:9,a:-1,t:"add"}]},"7b9sus":{text:"7",kind:"dominant",degrees:[{d:7,a:-1,t:"add"},{d:9,a:-1,t:"add"}]},"7b9#5":{text:"7",kind:"dominant",degrees:[{d:5,a:1,t:"alter"},{d:9,a:-1,t:"add"}]},"7b9#9":{text:"7",kind:"dominant",degrees:[{d:9,a:-1,t:"add"},{d:9,a:1,t:"add"}]},"7b9b13":{text:"7",kind:"dominant",degrees:[{d:9,a:-1,t:"add"},{d:13,a:-1,t:"add"}]},"7b9#11":{text:"",kind:"dominant",degrees:[{d:9,a:-1,t:"add"},{d:11,a:1,t:"add"}]},"7#9":{text:"7",kind:"dominant",degrees:[{d:9,a:1,t:"add"}]},"7#9b5":{text:"7",kind:"dominant",degrees:[{d:5,a:-1,t:"alter"},{d:9,a:1,t:"add"}]},"7#9#5":{text:"7",kind:"dominant",degrees:[{d:5,a:1,t:"alter"},{d:9,a:1,t:"add"}]},"7#9#11":{text:"7",kind:"dominant",degrees:[{d:9,a:1,t:"alter"},{d:11,a:1,t:"add"}]},"7#11":{text:"7",kind:"dominant",degrees:[{d:11,a:1,t:"add"}]},"7alt":{text:"7alt",kind:"dominant",degrees:[{d:5,a:-1,t:"alter"},{d:5,a:1,t:"add"},{d:9,a:-1,t:"add"},{d:9,a:1,t:"add"},{d:11,a:1,t:"add"},{d:13,a:-1,t:"add"}]},"7b13":{text:"7",kind:"dominant",degrees:[{d:13,a:-1,t:"add"}]},6:{text:"6",kind:"major-sixth"},69:{text:"6/9",kind:"major-sixth",degrees:[{d:9,a:null,t:"add"}]},"-6":{text:"m6",kind:"minor-sixth"},"-69":{text:"m6/9",kind:"minor-sixth",degrees:[{d:9,a:null,t:"add"}]},"^9":{text:"△9",kind:"major-ninth"},"^9#11":{text:"△9",kind:"major-ninth",degrees:[{d:11,a:1,t:"add"}]},"-9":{text:"m9",kind:"minor-ninth"},"-^9":{text:"m△9",kind:"major-minor",degrees:[{d:9,a:null,t:"add"}]},9:{text:"9",kind:"dominant-ninth"},"9sus":{text:"9sus4",kind:"dominant-ninth",degrees:[{d:3,a:1,t:"alter"}]},"9#5":{text:"9",kind:"dominant-ninth",degrees:[{d:5,a:1,t:"alter"}]},"9b5":{text:"9",kind:"dominant-ninth",degrees:[{d:5,a:-1,t:"alter"}]},"9#11":{text:"9",kind:"dominant-ninth",degrees:[{d:11,a:1,t:"add"}]},"^11":{text:"△11",kind:"major-11th"},"-11":{text:"m11",kind:"minor-11th"},11:{text:"11",kind:"dominant-11th"},"^13":{text:"△13",kind:"major-13th"},"-13":{text:"m13",kind:"minor-13th"},13:{text:"13",kind:"dominant-13th"},"13sus":{text:"13sus4",kind:"dominant-13th",degrees:[{d:3,a:1,t:"alter"}]},"13b9":{text:"13",kind:"dominant-13th",degrees:[{d:9,a:-1,t:"alter"}]},"13#9":{text:"13",kind:"dominant-13th",degrees:[{d:9,a:1,t:"alter"}]},"13#11":{text:"13",kind:"dominant-13th",degrees:[{d:11,a:1,t:"alter"}]}},i=null,s=null,c=[];if(t.modifiers in a){var d=a[t.modifiers];s=d.text,i=d.kind,"degrees"in d&&(c=d.degrees.map((function(e){return{degree:[{"degree-value":e.d},{"degree-alter":e.a},{"degree-type":e.t}]}})))}else console.warn('[MusicXML.convertChord] Unrecognized chord modifiers "'.concat(t.modifiers,'"'));var u=t.over?[{"bass-step":t.over.note[0]},h({},t.over.note[1]&&{"bass-alter":e.getMap(e.mapAlter,t.over.note[1],null,'[MusicXML.convertChord] Unrecognized accidental in bass note "'.concat(t.over.note,'"'))})]:null;n=[{root:[{"root-step":r},h({},o&&{"root-alter":o})]},{_name:"kind",_attrs:{text:s},_content:i},h({},u&&{bass:u})].concat(c)}t.alternate&&console.warn("[MusicXML.convertChord] Unhandled alternate chord ".concat(JSON.stringify(t.alternate)));var l=this.calculateChordDuration(1),f=l.duration,m=l.type,p=l.dots;return{harmony:n,note:this.convertChordNote(f,m,p),ireal:t,spaces:0}}},{key:"convertKey",value:function(){var e={C:0,G:1,D:2,A:3,E:4,B:5,"F#":6,"C#":7,F:-1,Bb:-2,Eb:-3,Ab:-4,Db:-5,Gb:-6,Cb:-7,"A-":0,"E-":1,"B-":2,"F#-":3,"C#-":4,"G#-":5,"D#-":6,"A#-":7,"D-":-1,"G-":-2,"C-":-3,"F-":-4,"Bb-":-5,"Eb-":-6,"Ab-":-7};return this.song.key in e?(this.fifths=e[this.song.key],{key:[{fifths:this.fifths},{mode:"-"===this.song.key.slice(-1)?"minor":"major"}]}):(console.warn('[MusicXML.convertKey] Unrecognized key signature "'.concat(this.song.key,'"')),null)}}],[{key:"convertDate",value:function(e){return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]}},{key:"reorderSequence",value:function(e,t){return e.filter((function(e){return Object.keys(e).length})).sort((function(e,n){var r=Object.keys(e)[0];"_name"===r&&(r=e[r]);var o=Object.keys(n)[0];"_name"===o&&(o=n[o]);var a=t.indexOf(r),i=t.indexOf(o);return-1===a&&console.warn('[MusicXML.reorderSequence] Unrecognized element "'.concat(r,'"')),-1===i&&console.warn('[MusicXML.reorderSequence] Unrecognized element "'.concat(o,'"')),a-i}))}},{key:"getMap",value:function(e,t,n,r){return t?t in e?e[t]:(console.warn(r),n):n}}]),e}();function k(e){var t=new i(e);return t.songs.forEach((function(e){e.musicXml=y.convert(e)})),t}g(y,"defaultOptions",{divisions:768,note:{type:"pitch",step:"B",octave:4,notehead:"slash"}}),g(y,"sequenceAttributes",["divisions","key","time","staves","part-symbol","instruments","clef","staff-details","transpose","directive","measure-style"]),g(y,"sequenceNote",["pitch","rest","unpitched","duration","voice","type","dot","notehead"]),g(y,"sequenceBarline",["bar-style","footnote","level","wavy-line","segno","coda","fermata","ending","repeat"]),g(y,"mapAlter",{"#":1,b:-1}),g(y,"mapFifthsToAlters",{0:[],1:["F"],2:["F","C"],3:["F","C","G"],4:["F","C","G","D"],5:["F","C","G","D","A"],6:["F","C","G","D","A","E"],7:["F","C","G","D","A","E","B"],"-1":["B"],"-2":["B","E"],"-3":["B","E","A"],"-4":["B","E","A","D"],"-5":["B","E","A","D","G"],"-6":["B","E","A","D","G","C"],"-7":["B","E","A","D","G","C","F"]}),g(y,"Measure",function(){function e(t){p(this,e),this.body={_name:"measure",_attrs:{number:t},_content:[]},this.attributes=[],this.chords=[],this.barlines=[],this.barEnding=0}return v(e,[{key:"number",value:function(){return this.body._attrs.number}},{key:"assemble",value:function(){var e=this;return this.attributes.length&&this.body._content.push({attributes:y.reorderSequence(this.attributes,y.sequenceAttributes)}),this.chords.forEach((function(t){e.body._content.push({harmony:t.harmony},{note:t.note})})),this.barlines[0]._content=y.reorderSequence(this.barlines[0]._content,y.sequenceBarline),this.body._content.splice(1,0,this.barlines[0]),this.barlines[1]._content=y.reorderSequence(this.barlines[1]._content,y.sequenceBarline),this.body._content.push(this.barlines[1]),this.body}}]),e}())},308:function(e,t){var n,r;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,void 0===(r="function"==typeof(n=function(e){"use strict";function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.toXML=void 0;var s="boolean",c="date",d="special-object",u=["_selfCloseTag","_attrs"],l=new RegExp(u.join("|"),"g"),h=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").repeat(e)},f=function(e){return(Array.isArray(e)?"array":"object"===i(e)&&null!==e&&e._name&&d)||e instanceof Date&&c||null===e&&"null"||i(e)},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)return e;var n=new RegExp("(".concat(Object.keys(t).join("|"),")(?!(\\w|#)*;)"),"g");return String(e).replace(n,(function(e,n){return t[n]||""}))},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Array.isArray(e)?e.map((function(e){var n=Object.keys(e)[0],r=e[n],o=t?m(r,t):r,a=!0===o?"":'="'.concat(o,'"');return"".concat(n).concat(a)})):Object.keys(e).map((function(n){var r=t?m(e[n],t):e[n],o=!0===e[n]?"":'="'.concat(r,'"');return"".concat(n).concat(o)}))},b=function(){var e=p(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0);if(0===e.length)return"";var t=e.join(" ");return" ".concat(t)},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).map((function(t){return{_name:t,_content:e[t]}}))},g=["string","number",s],y=function(e){return g.includes(f(e))},k=[].concat(g,[c,d]),_=function(e){return k.includes(f(e))},x=function(e){return!e.match("<")},j=function(e){var t=e.header,n=e.indent,r=e.isOutputStart;if(!t||!r)return"";var o=i(t)===s;return"".concat(o?'<?xml version="1.0" encoding="UTF-8"?>':t).concat(n?"\n":"")},w={"<":"&lt;",">":"&gt;","&":"&amp;"},O=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.depth,c=void 0===a?0:a,d=r.indent,p=r._isFirstItem,g=r.header,k=r.attributesFilter,O=void 0===k?{}:k,M=r.filter,C=void 0===M?{}:M,A="boolean"!=typeof O||O?o(o(o({},w),{'"':"&quot;"}),O):{},S="boolean"!=typeof C||C?o(o({},w),C):{},E=h(d,c),D=f(n),T=_(n),P=0===c&&(T||!T&&p),L="";switch(D){case"special-object":var X=n._name,B=n._content;if(null===B){L=X;break}if(Array.isArray(B)&&B.every(y))return B.map((function(t){return e({_name:X,_content:t},o(o({},r),{},{depth:c}))})).join("");if(X.match(l))break;var F=e(B,o(o({},r),{},{depth:c+1})),I=f(F),U=x(F),q="".concat(d&&!P?"\n":"").concat(E),G="undefined"===I||""===F,N=i(n._selfCloseTag)===s?G&&n._selfCloseTag:G,R=N?"/":"",z=b(n._attrs,A),K="<".concat(X).concat(z).concat(R,">"),Z=d&&!U?"\n".concat(E):"",$=N?"":"".concat(F).concat(Z,"</").concat(X,">");L="".concat(q).concat(K).concat($);break;case"object":var Q=Object.keys(n),W=Q.map((function(a,i){var s=o(o({},r),{},{_isFirstItem:0===i,_isLastItem:i+1===Q.length}),c={_name:a};if("object"===f(n[a])&&(u.forEach((function(e){var t=n[a][e];void 0!==t&&(c[e]=t,delete n[a][e])})),void 0!==n[a]._content&&Object.keys(n[a]).length>1)){var d=Object.assign({},n[a]);delete d._content,c._content=[].concat(t(v(d)),[n[a]._content])}return void 0===c._content&&(c._content=n[a]),e(c,s,a)}),r),J=d&&0===c?"\n":"";L=W.join(J);break;case"function":var Y=n(r);L=e(Y,r);break;case"array":var H=n.map((function(t,a){var i=o(o({},r),{},{_isFirstItem:0===a,_isLastItem:a+1===n.length});return e(t,i)})),V=d&&0===c?"\n":"";L=H.join(V);break;default:L=m(n,S)}var ee=j({header:g,indent:d,depth:c,isOutputStart:P});return"".concat(ee).concat(L)};e.toXML=O;var M={toXML:O};e.default=M})?n.apply(t,[t]):n)||(e.exports=r)}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(875)})()}));